# –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –ø—Ä–∞–π—Å-–ª–∏—Å—Ç–æ–≤

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ –ø—Ä–∞–π—Å-–ª–∏—Å—Ç—ã –∏–∑ –ø–∞–ø–∫–∏ `doc` –≤ –µ–¥–∏–Ω—É—é SQLite –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã

‚úÖ **–£—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ 10 —Ñ–∞–π–ª–æ–≤**
‚úÖ **–°–æ–∑–¥–∞–Ω–∞ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: `unified_pricelists.db`**
‚úÖ **–°–æ–∑–¥–∞–Ω–æ 14 —Ç–∞–±–ª–∏—Ü –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ª–∏—Å—Ç–æ–≤**
‚úÖ **–í—Å–µ–≥–æ —Å—Ç—Ä–æ–∫ –≤ –±–∞–∑–µ: 51,717**

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ñ–∞–π–ª–∞–º:
- `ekf_pricelist_blrrub_2025-09-09 –µ–∫—Ñ.xlsx`: 20,454 —Å—Ç—Ä–æ–∫ (–ü—Ä–æ–¥—É–∫—Ü–∏—è EKF)
- `zayavka77plus_SNG 21-08-2025.xlsx`: 19,403 —Å—Ç—Ä–æ–∫ (TDSheet)
- `–ü—Ä–∞–π—Å WOLTA PRO –æ—Ç 18.08.2025.xlsm`: 4,098 —Å—Ç—Ä–æ–∫ (WOLTA PRO)
- `–í–¢–õ –û—Å—Ç–∞—Ç–∫–∏ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞.xls`: 4,058 —Å—Ç—Ä–æ–∫ (TDSheet)
- `—ç–∫–æ–ª–∞ –ö–æ–ø–∏—è EcolaPrice_2025-08-18_–±–µ–∑_–∫–∞—Ä—Ç–∏–Ω–æ–∫.xls`: 2,514 —Å—Ç—Ä–æ–∫ (–õ–∏—Å—Ç1)
- `–ü—Ä–∞–π—Å WOLTA –æ—Ç 18.08.2025.xlsm`: 2,176 —Å—Ç—Ä–æ–∫ (—Ä–∞–∑–Ω—ã–µ –ª–∏—Å—Ç—ã)
- `–ü—Ä–∞–π—Å WOLTA PRO ESTETICA –æ—Ç 18.08.2025.xlsm`: 258 —Å—Ç—Ä–æ–∫ (—Ä–∞–∑–Ω—ã–µ –ª–∏—Å—Ç—ã)
- `–î–∂–µ–Ω–µ—Ä–∞–ª –ø—Ä–∞–π—Å.xlsx`: 0 —Å—Ç—Ä–æ–∫ (–æ—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏)
- `–ü—Ä–∞–π—Å-–ª–∏—Å—Ç –¢–ö –ü—Ä–æ—Ñ—ç–Ω–µ—Ä–¥–∂–∏.xls`: 0 —Å—Ç—Ä–æ–∫ (–æ—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏)
- `–§–ï–†–û–ù –ø—Ä–∞–π—Å 07.08.25.csv`: 0 —Å—Ç—Ä–æ–∫ (–æ—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫
```bash
./run.sh
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip3 install -r requirements.txt

# –ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
python3 merge_pricelists.py
```

## üìÅ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

- `.xlsx` - Excel 2007+
- `.xls` - Excel 97-2003  
- `.xlsm` - Excel —Å –º–∞–∫—Ä–æ—Å–∞–º–∏
- `.csv` - CSV —Ñ–∞–π–ª—ã

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö: `pricelists_metadata`
–°–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—Å–µ—Ö —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö:
- `table_name` - –∏–º—è —Ç–∞–±–ª–∏—Ü—ã –≤ –±–∞–∑–µ
- `source_file` - –∏—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª
- `source_sheet` - –Ω–∞–∑–≤–∞–Ω–∏–µ –ª–∏—Å—Ç–∞
- `row_count` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫
- `column_count` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–æ–ª–±—Ü–æ–≤
- `file_size_mb` - —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –≤ MB
- `file_format` - —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞

### –¢–∞–±–ª–∏—Ü—ã –¥–∞–Ω–Ω—ã—Ö
**–î–ª—è –∫–∞–∂–¥–æ–≥–æ –ª–∏—Å—Ç–∞ Excel —Ñ–∞–π–ª–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞** —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –≤–∏–¥–∞:
`–∏–º—è_—Ñ–∞–π–ª–∞_–Ω–∞–∑–≤–∞–Ω–∏–µ_–ª–∏—Å—Ç–∞`

–ö–∞–∂–¥–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç:
- `id` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- `source_row` - –Ω–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ
- `processed_at` - –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –í—Å–µ —Å—Ç–æ–ª–±—Ü—ã –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –ø—Ä–∞–π—Å-–ª–∏—Å—Ç–∞ (–Ω–∞–∑–≤–∞–Ω–∏—è –æ—á–∏—â–µ–Ω—ã –æ—Ç –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤)

## üîß –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã

- ‚úÖ **–û—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ª–∏—Å—Ç–∞** - –¥–∞–Ω–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º
- ‚úÖ **–ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞** (source_row)
- ‚úÖ **–î—É–±–ª–∏–∫–∞—Ç—ã –ù–ï –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è** (–∫–∞–∫ —Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å)
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü** –ø–æ –º–µ—Ä–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª–æ–≤
- ‚úÖ **–£–º–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–±–∏—Ä–∞–µ—Ç —Å–ª—É–∂–µ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
- ‚úÖ **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö –∫–æ–¥–∏—Ä–æ–≤–æ–∫** –¥–ª—è CSV —Ñ–∞–π–ª–æ–≤
- ‚úÖ **–î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –ø—Ä–æ—Ü–µ—Å—Å–∞
- ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö –ª–∏—Å—Ç–æ–≤** –≤ Excel —Ñ–∞–π–ª–∞—Ö

## üìã –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞

- `merge_pricelists.py` - –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è
- `view_data.py` - —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
- `export_to_excel.py` - —Å–∫—Ä–∏–ø—Ç –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ Excel
- `requirements.txt` - –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
- `run.sh` - bash —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
- `README.md` - –ø–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `unified_pricelists.db` - —Å–æ–∑–¥–∞–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- `merge_pricelists.log` - –ª–æ–≥ —Ñ–∞–π–ª

## üëÄ –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:
```bash
python3 view_data.py
```

### –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel:
```bash
python3 export_to_excel.py
```

### –ü—Ä—è–º—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã:
```bash
# –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü
sqlite3 unified_pricelists.db "SELECT name FROM sqlite_master WHERE type='table';"

# –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
sqlite3 unified_pricelists.db "SELECT * FROM pricelists_metadata;"

# –î–∞–Ω–Ω—ã–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
sqlite3 unified_pricelists.db "SELECT * FROM EcolaPrice_2025_08_18_1 LIMIT 5;"
```

## üõ†Ô∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.7+
- pip3
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: pandas, openpyxl, xlrd

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ —Ñ–∞–π–ª `merge_pricelists.log` —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ:
- –ü—Ä–æ—Ü–µ—Å—Å–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞
- –°–æ–∑–¥–∞–Ω–∏–∏ —Ç–∞–±–ª–∏—Ü
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫
- –í–æ–∑–º–æ–∂–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö

## üéâ –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞ —É –≤–∞—Å –±—É–¥–µ—Ç:
1. **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - –∫–∞–∂–¥–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –æ–¥–Ω–æ–≥–æ –ª–∏—Å—Ç–∞
2. **–ü–æ–ª–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä—É–µ–º–æ—Å—Ç—å** - –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –ø–æ–º–µ—á–µ–Ω–∞ –Ω–æ–º–µ—Ä–æ–º –≤ –∏—Å—Ö–æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ
3. **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∞–Ω–∞–ª–∏–∑—É** - –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω—ã –∏ –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è SQL –∑–∞–ø—Ä–æ—Å–æ–≤
4. **–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ** - –ø–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º –±–∞–∑—ã
5. **–ß–∏—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ** - —Å–ª—É–∂–µ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–∞

## üß† –£–º–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –≥–¥–µ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ Excel —Ñ–∞–π–ª–∞—Ö:

### üîç –ê–ª–≥–æ—Ä–∏—Ç–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤:
- **–ü–æ–∏—Å–∫ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤** - –∞—Ä—Ç–∏–∫—É–ª, –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ, —Ü–µ–Ω–∞, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏ —Ç.–¥.
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å—Ç—Ä–æ–∫–∏** - –º–∏–Ω–∏–º—É–º 3 –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —è—á–µ–π–∫–∏
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–ª—É–∂–µ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏** - –ª–æ–≥–æ—Ç–∏–ø—ã, –∫–æ–Ω—Ç–∞–∫—Ç—ã, –¥–∞—Ç—ã, –∫—É—Ä—Å—ã –≤–∞–ª—é—Ç
- **–ê–Ω–∞–ª–∏–∑ –ø–µ—Ä–≤—ã—Ö 20 —Å—Ç—Ä–æ–∫** –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞—á–∞–ª–∞ –¥–∞–Ω–Ω—ã—Ö

### üìä –ü—Ä–∏–º–µ—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:
- **EKF —Ñ–∞–π–ª**: —É–±—Ä–∞–Ω–æ 12 —Å–ª—É–∂–µ–±–Ω—ã—Ö —Å—Ç—Ä–æ–∫ (–ª–æ–≥–æ—Ç–∏–ø, –∫–æ–Ω—Ç–∞–∫—Ç—ã, –Ω–∞–≤–∏–≥–∞—Ü–∏—è)
- **WOLTA —Ñ–∞–π–ª—ã**: —É–±—Ä–∞–Ω–æ 7 —Å–ª—É–∂–µ–±–Ω—ã—Ö —Å—Ç—Ä–æ–∫ (–∑–∞–≥–æ–ª–æ–≤–∫–∏, –Ω–∞–≤–∏–≥–∞—Ü–∏—è)
- **–î—Ä—É–≥–∏–µ —Ñ–∞–π–ª—ã**: —É–±—Ä–∞–Ω–æ 2-11 —Å–ª—É–∂–µ–±–Ω—ã—Ö —Å—Ç—Ä–æ–∫ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ –ª—é–±—ã—Ö SQL-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ö!
